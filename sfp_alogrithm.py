# here is the sfp alogrithm